services:
  # 1. API Gateway
  - type: web
    name: api-gateway
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/APIGateway/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production

  # 2. IdentityService
  - type: web
    name: identity-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/IdentityService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false

  # 3. ProfileService
  - type: web
    name: profile-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/ProfileService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false

  # 4. MemoryArchiveService
  - type: web
    name: memory-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/MemoryArchiveService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false
      - key: Supabase__S3__Endpoint
        sync: false
      - key: Supabase__S3__AccessKey
        sync: false
      - key: Supabase__S3__SecretKey
        sync: false

  # 5. NotificationService
  - type: web
    name: notification-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/NotificationService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false
      - key: RabbitMq__Host
        sync: false
      - key: RabbitMq__User
        sync: false
      - key: RabbitMq__Password
        sync: false
      - key: RabbitMq__Queue
        sync: false
      - key: Redis__Host
        sync: false
      - key: Redis__Port
        sync: false
      - key: Redis__Password
        sync: false
      - key: Redis__Ssl
        sync: false

  # 6. AccessControlService
  - type: web
    name: access-control-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/AccessControlService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false

  # 7. AuditLoggingService
  - type: web
    name: audit-logging-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/AuditLoggingService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false
      - key: RabbitMq__Host
        sync: false
      - key: RabbitMq__User
        sync: false
      - key: RabbitMq__Password
        sync: false
      - key: RabbitMq__Queue
        sync: false

  # 8. ModerationService (NEW)
  - type: web
    name: moderation-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/ModerationService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false
      # добавь свои переменные модерации при необходимости (например, ключи провайдера)

  # 9. PublicViewService (NEW)
  - type: web
    name: public-view-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/PublicViewService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false

  # 10. QRCodeService (NEW)
  - type: web
    name: qrcode-service
    runtime: docker
    repo: https://github.com/AndreyFesenko/Memories-alone
    region: frankfurt
    branch: master
    plan: free
    autoDeploy: true
    dockerfilePath: ./src/QRCodeService/Dockerfile
    dockerContext: ./src
    healthCheckPath: /health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__Default
        sync: false
